{"version":3,"file":"compile-state.js","sources":["../../../../src/services/kolay/compiler/compile-state.ts"],"sourcesContent":["import { tracked } from '@glimmer/tracking';\nimport { assert } from '@ember/debug';\n\nimport type { ComponentLike } from '@glint/template';\n\nexport class CompileState {\n  @tracked isCompiling = true;\n  @tracked error: null | string = null;\n  @tracked component: ComponentLike<{}> | undefined;\n\n  #promise: Promise<ComponentLike>;\n  #resolve?: (value: ComponentLike) => void;\n  #reject?: (value: unknown) => void;\n\n  constructor() {\n    this.#promise = new Promise((resolve, reject) => {\n      this.#resolve = resolve;\n      this.#reject = reject;\n    });\n  }\n\n  then = (\n    ...args: [\n      | ((value: ComponentLike) => ComponentLike | PromiseLike<ComponentLike>)\n      | null\n      | undefined,\n    ]\n  ) => this.#promise.then(...args);\n\n  success = (component: ComponentLike) => {\n    assert(`Resolve is missing`, this.#resolve);\n    this.component = component;\n    this.isCompiling = false;\n    this.error = null;\n    this.#resolve(component);\n  };\n\n  fail = (error: string) => {\n    assert(`Reject is missing`, this.#reject);\n    this.error = error;\n    this.#reject(error);\n  };\n\n  get isReady() {\n    return !this.isCompiling;\n  }\n}\n"],"names":["CompileState","g","prototype","tracked","i","void 0","constructor","Promise","resolve","reject","then","args","success","component","assert","isCompiling","error","fail","isReady"],"mappings":";;;;AAKO,MAAMA,YAAY,CAAC;AAAA,EAAA;IAAAC,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,aAAA,EAAA,CACvBC,OAAO,CAAA,EAAA,YAAA;AAAA,MAAA,OAAe,IAAI;AAAA,KAAA,CAAA;AAAA;AAAA,EAAA,YAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,aAAA,CAAA,EAAAC,KAAA,CAAA;AAAA,EAAA;IAAAJ,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,OAAA,EAAA,CAC1BC,OAAO,CAAA,EAAA,YAAA;AAAA,MAAA,OAAwB,IAAI;AAAA,KAAA,CAAA;AAAA;AAAA,EAAA,MAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,OAAA,CAAA,EAAAC,KAAA,CAAA;AAAA,EAAA;IAAAJ,CAAA,CAAA,IAAA,CAAAC,SAAA,EAAA,WAAA,EAAA,CACnCC,OAAO,CAAA,CAAA;AAAA;AAAA,EAAA,UAAA,IAAAC,CAAA,CAAA,IAAA,EAAA,WAAA,CAAA,EAAAC,KAAA,CAAA;AAER,EAAA,QAAQ;AACR,EAAA,QAAQ;AACR,EAAA,OAAO;AAEPC,EAAAA,WAAWA,GAAG;IACZ,IAAI,CAAC,QAAQ,GAAG,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;AAC/C,MAAA,IAAI,CAAC,QAAQ,GAAGD,OAAO;AACvB,MAAA,IAAI,CAAC,OAAO,GAAGC,MAAM;AACvB,KAAC,CAAC;AACJ;AAEAC,EAAAA,IAAI,GAAGA,CACL,GAAGC,IAIF,KACE,IAAI,CAAC,QAAQ,CAACD,IAAI,CAAC,GAAGC,IAAI,CAAC;EAEhCC,OAAO,GAAIC,SAAwB,IAAK;AACtCC,IAAAA,MAAM,CAAC,CAAoB,kBAAA,CAAA,EAAE,IAAI,CAAC,QAAQ,CAAC;IAC3C,IAAI,CAACD,SAAS,GAAGA,SAAS;IAC1B,IAAI,CAACE,WAAW,GAAG,KAAK;IACxB,IAAI,CAACC,KAAK,GAAG,IAAI;AACjB,IAAA,IAAI,CAAC,QAAQ,CAACH,SAAS,CAAC;GACzB;EAEDI,IAAI,GAAID,KAAa,IAAK;AACxBF,IAAAA,MAAM,CAAC,CAAmB,iBAAA,CAAA,EAAE,IAAI,CAAC,OAAO,CAAC;IACzC,IAAI,CAACE,KAAK,GAAGA,KAAK;AAClB,IAAA,IAAI,CAAC,OAAO,CAACA,KAAK,CAAC;GACpB;EAED,IAAIE,OAAOA,GAAG;IACZ,OAAO,CAAC,IAAI,CAACH,WAAW;AAC1B;AACF;;;;"}